\section{Correlaciones}\label{correlaciones}

El Laboratorio de Átomos Fríos y Óptica Cuántica del Instituto de Física de la UNAM --- parte del Laboratorio Nacional de Materia Cuántica --- tiene como propósito hacer investigación en metrología e información cuántica, por medio del estudio de sistemas cuánticos ópticos y materiales.

El experimento principal del Laboratorio es el de generación de pares de fotones (o \textit{bifotones}) por medio de un proceso no lineal llamado \textit{mezclado de cuatro ondas} --- o FWM por sus siglas en inglés. En el laboratorio, este proceso de FWM es realizado actualmente en una muestra de átomos de rubidio calientes, y próximamente se realizará también en una muestra de átomos fríos.

\subsection{Motivación}\label{motivacion_correlaciones}

La técnica más estándar para generar bifotones es la de procesos de conversión espontánea paramétrica descendiente\cite{burnham} (o SPDC por sus siglas en inglés) en cristales no lineales, como BBO. Sin embargo, el tiempo de coherencia de los fotones generados en SPDC es muy corto (del orden de ps) gracias a que poseen un amplio ancho de banda. Esto impide ciertos experimentos interesantes; incluso sistemas de detección fotónica con tecnología de punta tienen una resolución temporal de al menos decenas de ps\cite{Lukens:15}. Además, la corta longitud de coherencia los hacen poco viables para interacciones átomo--fotón, haciéndolos poco deseables para estudios de información cuántica\cite{PhysRevLett.88.243602}.

Por esto, en años recientes ha aumentado mucho el interés en generar pares de fotones con un ancho de banda angosto. Una solución simple es colocar el cristal para SPDC en una cavidad óptica\cite{PhysRevLett.101.190501}. Sin embargo, el avance en técnicas de enfriamiento de átomos ha permitido estudiar la generación de bifotones en gases atómicos fríos por medio de procesos de FWM espontáneo. Utilizar este proceso trae varios beneficios: bifotones con un ancho de banda muy angosto, mayor eficiencia de producción y varios parámetros experimentales para poder controlar la función de onda resultante\cite{Du:08}. En este laboratorio, el corazón de este futuro experimento consiste en un gas de átomos de $Rb$, confinados y enfriados por medio de una trampa magneto-óptica (o MOT). Una breve explicación de nuestra MOT se dará en la sección \textbf{ESPECTROSCOPIA MOTIVACIÓN}, y una descripción más detallada puede encontrarse en \cite{Adrian}. A pesar de que el proceso de FWM en átomos fríos todavía no se implementa en el laboratorio, hay varios aspectos del experimento que necesitan desarrollo, como los sistemas de control y adquisición de datos así como la caracterización y optimización de la nube atómica.

%El sistema de generación fotónica que decidió usarse en este laboratorio fue el de FWM en una nube atómica a bajas temperaturas.
Por la naturaleza sensible de este experimento, el desarrollo de un sistema dedicado de adquisición de datos era necesario. Dicho sistema se diseñó para el procesamiento, almacenamiento y posterior procesamiento de los datos experimentales que permitirían el estudio de correlaciones en la luz generada. A continuación se presentará la motivación y desarrollo del trabajo de este capítulo. 

\subsubsection{Luz cuántica}\label{luzcuantica}

El primer propósito del estudio de fotones individuales es estudiar las correlaciones entre ellos. En 1986, Grangier et al\cite{grangier} generaron haces de fotones individuales utilizando decaimientos atómicos en cesio para demostrar algunas propiedades cuánticas de la luz. En particular, buscaban estudiar las correlaciones entre foto-detectores para las salidas de transmisión y reflección en un divisor de haz. Si --- citando a Grangier --- \textit{sólo se puede detectar un fotón una sola vez}, entonces habremos probado propiedades granulares de la luz y no habría duda de que sólo se puede describir de manera cuántica, i.e., con su función de onda.

Ahora, si uno considera cada fotón como un campo eléctrico propio, es de interés ver cuáles son las correlaciones que se pueden medir entre ellos. En la sección \ref{teoria_correlaciones}, se presentarán los conceptos sobre lo que se entiende por \textit{correlaciones} en nuestro sistema, así como una breve descripción matemática acerca de cómo calcularlas.

%Finalmente, la tasa de generación de fotones es muy baja, aún usando técnicas comunes en la academia\cite{Cere:1}. Por ello, es importante tratar de optimizar aquellos parámetros experimentales que mejoren

\subsubsection{Preparación del sistema}
Al pensar en un sistema de adquisición de datos se deben también tener en cuenta los dispositivos necesarios para la generación de fotones como los haces láser usados y los instrumentos de detección, así como la óptica que ayudará a guiar a los fotones a los detectores. Es así que surge una motivación natural de caracterizar estos sistemas como parte de un trabajo más completo.

El arreglo óptico se divide en la parte de bombeo (la luz que llega a la nube de átomos) y la parte de adquisición (la luz resultante que será analizada). La óptica de bombeo se describirá en el capítulo \textbf{ESPECTROSCOPIA} correspondiente al experimento de espectroscopía, pues es más relevante a ese experimento. El montaje de la óptica de bombeo consiste principalmente en un arreglo de filtros de interferencia SEMROCK LL01-780 para filtrar los haces de bombeo y dos fotodiodos de avalancha (APDs) para la detección de eventos. La recolección de esta luz hacia los APDs se realiza por medio de dos fibras ópticas \textbf{THORLABS SERIAL NUMBER}.

Aún con técnicas estándar hoy en día, la tasa de generación de bifotones en experimentos de este tipo es baja\cite{Cere:1}; es por esto que es importante obtener la mayor eficiencia posible a la hora de acoplar las fibras ópticas. El problema del acoplamiento consiste en la alineación del haz incidente y de la fibra para maximizar la potencia transferida. En condiciones ideales, uno podría conseguir un porcentaje de acoplamiento a la fibra de casi 100\%\cite{Ladany:93}, pero hacerlo es laborioso y necesita de múltiples elementos ópticos. El acoplamiento de luz láser a una fibra monomodal es un problema de empatamiento de modos\cite{Newport}:
\begin{equation}
\label{acoplamiento}
f = D\frac{\pi \omega}{4\lambda},
\end{equation}

donde $f$ es la distancia focal de la lente necesaria para acoplar un haz de diámetro $1/e^2$ $D$ y longitud de onda $\lambda$ a una fibra con modo $\omega$. De la ecuación \ref{acoplamiento}, vemos que el diámetro del haz es un parámetro controlable importante para conseguir un buen acoplamiento. Por esto, se decidió escribir un sencillo programa de computadora para analizar perfiles de haces láser utilizando fotos tomadas con un chip CCD.

\textbf{IMG montaje optico}

El montaje óptico que se decidió utilizar se observa en la figura \textbf{LABEL}, en donde pudimos obtener eficiencias de hasta el 81\% para el acoplamiento de láseres del experimento, gracias al uso de lentes asféricas \textbf{THORLABS}, así como de una montura Thorlabs SM1Z que nos permitió un ajuste fino de la distancia de la fibra al lente a lo largo del eje óptico.

\subsubsection{Instrumentos}
Para la detección y procesamiento de señales se utilizarán dos instrumentos: varios APD de silicón (\textit{id120}) y un etiquetador de cuentas temporales (\textit{id800}) fabricados por IDQuantique.

Un APD es un un diodo p-n con una ganancia alta. Estos instrumentos tienen un mecanismo interno de amplificación, que genera señales eléctricas con alta tasa señal-ruido como respuesta a detecciones de un sólo fotón\cite{Cork}. Las cuentas detectadas por un APD pueden tener distintas fuentes:
\begin{itemize}
\item Fotones individuales, que pueden ser registrados correctamente o como \textit{afterpulses}.
\item \textit{Cuentas obscuras}, señales generadas por el mismo APD sin luz externa incidente. La tasa de cuentas obscuras (\textit{dark count rate}) es dependiente de la temperatura del detector y el voltaje de polarización (bias).
\end{itemize}

Los APD \textit{id120} cuentan con una zona de detección de $500\mu m$ de diámetro y una eficiencia cuántica de 80\% para $800nm$. Es necesario optimizar los valores del voltaje de bias aplicado para minimizar el \textit{afterpulsing} y el \textit{dark count rate} --- optimización que no forma parte del presente trabajo, pues el experimento de FWM sigue en fase de planeación. Sin embargo, una descripción mucho más detallada de el funcionamiento y las tasas de generación de eventos en APDs puede encontrarse en \cite{Michalet}.

Una desventaja de la elección de \textit{id120} es que no tienen un trigger interno capaz de ser activado de manera externa, por lo que fue necesario diseñar un circuito de \textit{gating} utilizando búferes de tres estados.

Finalmente, el \textit{id800} es un módulo etiquetador de cuentas temporales (time-to-digital converter, TDC). Cuenta con 8 canales de entrada BNC con una resolución temporal de 81ps para coincidencias de eventos en canales distintos. El \textit{id800} cuenta con un software de LabView para el procesamiento de cuentas, pero la funcionalidad que ofrecía no era adecuada para experimentos de FWM. Por ello, se optó por escribir una biblioteca completa para Python 3.6, para permitir la programación del módulo. Con esta biblioteca, se escribió un programa para procesar y visualizar en tiempo real las cuentas que el TDC reciba.

Todo el software, la electrónica y las pruebas correspondientes se encuentran en la sección \ref{sistemas_correlaciones}.

\subsection{Teoría}\label{teoria_correlaciones}
En esta sección se presentará una descripción de los elementos teóricos utilizados en este capítulo. Partiendo de una descripción clásica de la luz, se introducirán los conceptos de \textit{coherencia} de primer y segundo grado, que nos permitirán clasificar luz de distintas fuentes de acuerdo a la estadística que siguen. Finalmente, se realizará una cuantización del campo  Este desarrollo sigue principalmente la exposición de \textbf{Kenyon, Loudon y Fox}, respectivamente.

\subsubsection{Óptica clásica}\label{optica_clasica}
Aunque muchos efectos ópticos clásicos pueden ser descritos por óptica geométrica, para poder explicar efectos como interferencia y difracción, que necesitan el tratamiento clásico de la luz como ondas.

Aunque no fue el primero en proponerlas, la teoría de Maxwell de la luz como ondas electromagnéticas está descrita en términos del campo eléctrico $\E(\textbf{r},t)$ y el campo magnético $\B(\textbf{r},t)$; para el campo electromagnético en materiales, se definen de manera más general el campo de desplazamiento $\D(\textbf{r},t)$ y la cantidad magnética $\Hmag(\textbf{r},t)$.

En un material homogéneo e isotrópico, la descripción de estos campos generales es:
\begin{align*}
\D &= \epsilon_0\epsilon_r\E & \B &= \mu_0\mu_r\Hmag,
\end{align*}
donde $\epsilon_0$ y $\mu_0$ son la permitividad eléctrica y permeabilidad magnética del vacío, respectivamente, y $\epsilon_r$ y $\mu_r$ la permitividad eléctica y permeabilidad magnética del medio.

Las ecuaciones que describen la respuesta de un medio al campo eléctrico y magnético fueron compiladas por Maxwell:
\begin{align}
\divr\D &= \rho, \\
\divr\B &= 0, \\
\curl\E &= -\frac{\partial \B}{\partial t}, \\
\curl\Hmag &= \bm{j} + \frac{\partial \D}{\partial t},
\end{align}
donde $\rho$ es la densidad de carga libre y $\bm{j}$ la corriente de carga libre. En el vacío (y sin densidad ni corriente de carga libre) $\epsilon_r = \mu_r = 1$ y las ecuaciones de Maxwell son:

\begin{align}
\divr\E &= 0, \label{gauss_elec}\\
\divr\B &= 0, \label{gauss_mag}\\
\curl\E &= -\frac{\partial \B}{\partial t}, \label{faraday}\\
\curl\B &=\mu_0\epsilon_0\frac{\partial \E}{\partial t}, \label{ampere}
\end{align}

Tomando el rotacional de la ecuación \ref{faraday}, y combinándolo con la ecuación \ref{ampere}:
\begin{equation*}
\curl(\curl\E) = -\frac{\partial}{\partial t}\curl\B = - \mu_0\epsilon_0\frac{\partial}{\partial t}\frac{\partial\E}{\partial t} = -\mu_0\epsilon_0\frac{\partial^2\E}{\partial^2 t}.
\end{equation*}
Por otro lado, utilizando que para cualquier campo vectorial $\bm{\mathcal{A}}$ es cierto que:
\begin{equation}
\nonumber \curl(\curl \bm{\mathcal{A}}) = \nabla(\divr \bm{\mathcal{A}}) - \nabla^2\bm{\mathcal{A}},
\end{equation}
y el hecho que el primer término del lado derecho es cero por la ecuación \ref{gauss_elec}, tenemos que
\begin{equation}
\nabla^2\E(\bm{r},t) = \mu_0\epsilon_0\frac{\partial^2\E(\bm{r},t)}{\partial^2 t},
\end{equation}
que corresponde a una ecuación de onda con velocidad $c = 1/\sqrt{\mu_0\epsilon_0} = 2.998\times 10^8 ms^{-1}$, que es la velocidad de la luz en el vacío.
De una manera análoga se encuentra una ecuación de onda para el campo magnético $\B$.

\subsubsection{Coherencia}\label{coherencia}
Vale la pena hablar primero del efecto de interferencia. La interferencia es el efecto de la recombinación de dos ondas en movimiento; patrones de interferencia ocurren cuando estas dos ondas presentan una diferencia relativa de fase. En el contexto del campo electromagnético, existen varios ejemplos que sirven para dejarlo en claro: el experimento de la doble rendija de Young, el interferómetro de Michaelson o el interferómetro de Mach Zehnder.

Si dos trenes de ondas presentan una relación bien determinada de fase entre ellos, se dice que son \textit{coherentes}. En una situación ideal, si conocemos esta relación de fase para un tiempo inicial, podríamos deducir la fase relativa en todo momento. La vida real, por desgracia, no funciona así y en realidad tenemos fluctuaciones en la fase que suceden conforme pasa el tiempo. Sin embargo, si la diferencia de fase entre las dos ondas permanece relativamente constante dentro de un intervalo $\tau_c$, decimos que son \textit{parcialmente coherentes} con un tiempo de coherencia $\tau_c$. En este sentido, la coherencia es una medida de la estabilidad de frecuencia de la luz: podremos predecir acertadamente la fase de una onda para un tiempo $t + \tau$, siempre y cuando $\tau << \tau_c$. De manera inmediata podemos obtener la distancia de coherencia $d_c = c\tau_c$ y medir la fase en dos puntos distintos en el espacio.

Para cuantificar la coherencia, calculamos la \textit{correlación}.

\textbf{MACH ZEHNDER}

La figura \textbf{DE ARRIBA} muestra un esquema sencillo del interferómetro de Mach Zehnder. Supongamos que tenemos un campo eléctrico incidente $\E(t)$ incidente sobre el primer divisor de haz, que asumimos idéntico al segundo y ambos con coeficiente de reflexión $\mathcal{R}$ y coeficiente de transmisión  $\mathcal{T}$. Después de pasar por el primer divisor, el haz reflejado y el transmitido recorren una distancia $l_1$ y $l_2$, respectivamente, usualmente diseñadas de distinta magnitud. Al recombinarse en el segundo divisor, tendremos dos salidas:
\begin{align*}
\E_A(t) &= \mathcal{RT}\E(t_1) + \mathcal{TR}\E(t_2) \propto \E(t_1) + \E(t_2),\\
\E_B(t) &= \mathcal{TT}\E(t_2) + \mathcal{RR}\E(t_1),
\end{align*}
con $t_1 = t - l_1/c$ y $t_2 = t - l_2/c$.

Consideremos la intensidad del campo $\E_A(t)$ al tiempo $t$:
\begin{align*}
I_A(t) &\propto |\E(t_1) + \E(t_2)|^2 = \mathcal{E}(t_1)^2 + \mathcal{E}(t_2)^2 + 2\E(t_1)\cdot\E(t_2).
\end{align*}
En la realidad no podemos medir la intensidad de manera instantántea, por lo que tomamos la intensidad promediada:
\begin{equation}
\langle I_A(t)\rangle \propto \langle\mathcal{E}(t_1)^2\rangle + \langle\mathcal{E}(t_2)^2\rangle + 2\langle\E(t_1)\cdot\E(t_2)\rangle.
\end{equation}

Vemos que tenemos tres contribuciones a la intensidad medida. Las primeras dos corresponden a la intensidad que mediríamos de cada campo después de recorrer su brazo del interferómetro de manera independiente, \textit{i.e.}, sin efectos de interferencia. Sin embargo, el tercer término contiene la información de la \textit{correlación} de cada haz.

Si, sin pérdida de generalidad, consideramos que $t_1 < t_2 = t_1 + \tau$, podemos ver que la correlación dependerá de esta diferencia temporal $\tau$ a partir de un tiempo dado, más que de valores particulares de $t_1$ o $t_2$, siempre y cuando la naturaleza de $\E(t)$ nos permita tomar promedios sin mucho problema. De manera más general, el tercer término está definido de manera estadística como:
\begin{equation}
\langle\E(t)\cdot\E(t+\tau)\rangle = \cfrac{1}{T}\int_T dt \ \E^*(t)\E(t+\tau)\equiv \langle\mathcal{E}^*(t)\mathcal{E}(t+\tau)\rangle ,
\end{equation} 

que se conoce como la \textit{función de correlación de primer orden}. El \textit{grado de coherencia temporal de primer orden} se define como la versión normalizada de la función de correlación de primer orden:
\begin{equation}
\g{1}(\tau) = \cfrac{\left\langle \mathcal{E}^*(t)\mathcal{E}(t+\tau) \right\rangle}{\left\langle\mathcal{E}^*(t)\mathcal{E}(t)\right\rangle}.
\end{equation}  

Veamos cómo se ve $\g{1}(\tau)$ para distintos tipos de luz.
\subsubsection*{Luz caótica}\label{luz_termica}

Consideremos a una fuente de luz caótica como un ensamble de muchos átomos que emiten luz de manera independiente unos de otros. Si se da una colisión entre ellos, la fase de la luz emitida cambia (y permanece constante hasta que ocurra otra colisión) pero su amplitud $E_0$ y frecuencia $\omega_0$ permanecen constantes.Podemos modelar este cambio de fase como una función $\phi(t)$ que va cambiando en $[0,2\pi]$, y si observamos este campo en un punto espacial fijo:
\begin{equation}
\nonumber \E(t) = E_0e^{-i\omega_0t + i\varphi(t)}.
\end{equation}
Suponiendo que podemos superponer cada campo individual para obtener el campo eléctrico total:
\begin{align*}
\E(t) &= \E_1(t) + \E_2(t) + ... + \E_n(t)\\
\E(t) &= E_0e^{-i\omega_0t}\left(e^{i\varphi_1(t) + i\varphi_2(t) + ... + i\varphi_n(t)}\right)
\end{align*}

Si calculamos $\g{1}(\tau)$ para esta fuente de luz:

\begin{align*}
\langle\mathcal{E}^*(t)\mathcal{E}(t+\tau)\rangle = E_0^2 e^{-i\omega_0\tau}&\times\langle\{e^{-i\varphi_1(t)} + e^{-i\varphi_2(t)} + ...  +e^{-i\varphi_n(t)}\}\\
&\times\{e^{i\varphi_1(t+\tau)} + e^{i\varphi_2(t+\tau)} + ...  +e^{i\varphi_n(t+\tau)}\}\rangle.
\end{align*}
Al tomarse el promedio estadístico, los términos cruzados se eliminan pues corresponden a saltos aleatorios distintos (y promedian cero al considerarse el ensamble completo). Así,
\begin{align}
\nonumber\langle\mathcal{E}^*(t)\mathcal{E}(t+\tau)\rangle &=  E_0^2e^{-i\omega_0\tau}\sum_{j=1}^n\langle e^{i\phi_j(t+\tau) - i\phi_j(t)}\rangle\\
\nonumber&= nE_0^2e^{-i\omega_0\tau}\langle e^{i\phi_j(t+\tau) - i\phi_j(t)}\rangle\\
&= n\langle\mathcal{E}_j^*(t)\mathcal{E}_j(t+\tau)\rangle, \label{eq15}
\end{align}
ya que cada átomo es indistinguible de los demás.

Finalmente, calculemos $\langle\mathcal{E}_j^*(t)\mathcal{E}_j(t+\tau)\rangle$. De la teoría cinética de los gases, sabemos que la probabilidad de que haya un tiempo entre colisiones dentro del intervalo $[\tau,\tau+d\tau]$ (donde la fase del campo es constante) es:
\begin{equation}
p(\tau)d\tau = (1/\tau_c)e^{(\tau/\tau_c)}d\tau,
\end{equation}
donde $\tau_c$ es el tiempo característico de vuelo, o tiempo de coherencia. Usando esta distribución de probabilidad para calcular $\langle\mathcal{E}_j^*(t)\mathcal{E}_j(t+\tau)\rangle$,
\begin{align}
\nonumber \langle\mathcal{E}_j^*(t)\mathcal{E}_j(t+\tau)\rangle &= E_0^2e^{-i\omega_0\tau}\langle e^{i\phi_j(t+\tau) - i\phi_j(t)}\\
\nonumber &= E_0^2e^{-i\omega_0\tau}\int_\tau ^\infty d\tau' p(\tau')\\
\nonumber &= E_0^2e^{-i\omega_0\tau} e^{\tau/\tau_c}.
\end{align}

Finalmente, de la ecuación \ref{eq15} obtenemos que:
\begin{equation}
\g{1}(\tau) = e^{-i\omega\tau- \tau/\tau_c}.
\end{equation}

Para una fuente de luz caótica con ensanchamiento Doppler se puede hacer un análisis similar. Partiendo de la expresión del campo eléctrico para este tipo de luz:
\begin{equation*}
\E(t) = E_0\sum_{i=1}^n e^{-i\omega_i t + i\varphi_i}.
\end{equation*}

Aunque la fase del $i$-ésimo átomo es constante (dado que asumimos que no hay colisiones atómicas), están distribuidos de manera aleatoria y las contribuciones de fase de distintos átomos promediará cero. Además, cada átomo tiene una frecuencia de radiación $\omega_i$ recorrida de la frecuencia central $\omega_0$, determinada por su velocidad. 

Calculando $\langle\mathcal{E}^*(t)\mathcal{E}(t+\tau)\rangle$, obtenemos que:
\begin{equation}
\g{1}(\tau) = e^{-i\omega_0\tau - \frac{\pi}{2}(\tau/\tau_c)^2}.
\end{equation}

\textbf{FIGURA DE g(1) PARA AMBAS FUENTES}

Vemos que la magnitud de $\g{1}(\tau)$ para luz caótica ensanchada por colisiones tiene un perfil Lorentziano, mientras que para luz caótica ensanchada por Doppler presenta un perfil Gaussiano. $|\g{1}(0)| = 1$ es el máximo y decrece monotónicamente hacia $0$.

\subsubsection*{Luz láser}\label{luz_laser}

De manera ideal, un láser emite una sola frecuencia y tiene coherencia perfecta. Podemos describirlo por una onda sinusoidal con una fase $\varphi$ bien definida en todo momento, y observándolo en un punto fijo a lo largo de la dirección de propagación:
\begin{equation}
\E(t) = E_0 e^{-i\omega_0t + i\varphi}. \label{eq19}
\end{equation}

Vemos entonces que:
\begin{align*}
\langle\mathcal{E}^*(t)\mathcal{E}(t+\tau)\rangle &= E_0^2 e^{-i\omega_0\tau},
\end{align*}
y
\begin{equation}
\g{1}(\tau) = e^{-i\omega_0\tau}.
\end{equation}

Es inmediato que $|\g{1}(\tau)| = 1$ para todo $\tau$, que significa que la luz láser es perfectamente coherente.

\subsubsection*{Función de correlación de segundo orden}
El experimento de interferencia de intensidades que realizaron Hanbury Brown y Twiss\cite{hbt} mostró que el análisis de las correlaciones entre intensidades era interesante. Justo como consideramos el grado de coherencia temporal de primer orden como una medida de la correlación entre amplitudes, el \textit{grado de coherencia temporal de segundo orden} es una medida de la correlación entre intensidades. La función $\g{2}(\tau)$ mide esencialmente fluctuaciones en la intensidad y se define como:
\begin{equation}
\g{2}(\tau) = \cfrac{\langle\mathcal{E}^*(t)\mathcal{E}^*(t+\tau)\mathcal{E}(t+\tau)\mathcal{E}(t)\rangle}{\langle\mathcal{E}^*(t)\mathcal{E}(t)\rangle \langle\mathcal{E}^*(t+\tau)\mathcal{E}(t+\tau)\rangle} = \cfrac{\langle I(t)I(t+\tau)\rangle}{\langle I(t)\rangle\langle I(t+\tau)\rangle}.
\end{equation}

De acuerdo con esta descripción clásica de la luz, es posible probar con la \textit{desigualdad de Cauchy-Schwartz} que:
\begin{align}
1 &\leq \g{2}(0) \label{g0_clasica}\\
\g{2}(\tau) &\leq \g{2}(0).
\end{align}

Para una fuente clásica de luz láser como la descrita por la ecuación \ref{eq19}, es trivial probar que:
\begin{equation}
\g{2}(\tau) = 1,
\end{equation}
para todo $\tau$ --- sigue siendo perfectamente coherente en intensidad.

Para las fuentes de luz caótica se puede demostrar que, si se tiene un número $n$ muy grande de átomos, es válido:
\begin{equation}
\langle\mathcal{E}^*(t)\mathcal{E}^*(t+\tau)\mathcal{E}(t+\tau)\mathcal{E}(t)\rangle = n^2\left[\langle\mathcal{E}_i^*(t)\mathcal{E}_i(t)\rangle^2 + |\langle\mathcal{E}_i^*(t)\mathcal{E}_i(t+\tau)\rangle|^2\right]. \label{eq22}
\end{equation}

Usando \ref{eq22} en la definición de $\g{2}$, tenemos que para luz caótica (y para $n>>1$):
\begin{equation}
\nonumber \g{2}(\tau) = 1+|\g{1}(\tau)|^2,
\end{equation}
quedando para luz caótica con colisiones y con ensanchamiento Doppler:
\begin{align}
\g{2}(\tau) &= 1 + e^{-2\tau/\tau_c}, & \g{2}(\tau) &= 1 + e^{-\pi(\tau/\tau_c)^2}.
\end{align}

\textbf{g(2) PARA LAS TRES LUCES CLÁSICAS}

\subsubsection{Cuantización del campo}\label{optica_cuantica}
De la teoría clásica del campo electromagnético \textbf{Loudon}, sabemos que el campo eléctrico $\E(\bm{r},t)$ y el campo magnético $\B(\bm{r},t)$ son campos vectoriales dependientes del tiempo que en vacío dependen de un tercer campo $\A(\bm{r},t)$ (el potencial vectorial) y un campo escalar $\phi(\bm{r},t)$:
\begin{align*}
\B(\bm{r},t) &=\curl\A(\bm{r},t), \\
\E(\bm{r},t) &=-\nabla\phi(\bm{r},t) - \cfrac{\partial\A(\bm{r},t)}{\partial t}.
\end{align*}

De acuerdo a las expresiones anteriores, el Hamiltoniano clásico tiene la forma
\begin{equation}
H = \frac{1}{2}\epsilon_0 \int\int\int_V d^3\bm{r} \ \left(|\E(\bm{r},t)|^2 + c^2|\B(\bm{r},t)|^2\right). \label{Hamiltoniano}
\end{equation}

Tomando la norma de Coulomb, (para la cual $\divr\A = 0$), se puede demostrar que la expansión de Fourier del potencial vectorial es:
\begin{equation}
\A(\bm{r},t) = \sum_{\bm{k}}\sum_{\mu =\pm 1}\left(\bm{e}^{(\mu)}(\bm{k})a_{\bm{k}}^{(\mu)}(t)e^{i\bm{k}\cdot\bm{r}} + \bm{e}^{*(\mu)}(\bm{k})a^{*(\mu)}_{\bm{k}}(t)e^{-i\bm{k}\cdot\bm{r}}\right),
\end{equation}
con $\bm{e}^{(\pm 1)}$ los vectores unitarios de polarización circular y $\bm{k}$ es el vector de onda.

Si aplicamos las reglas de cuantización equivalentes a $\hat{\bm{p}}(t) \rightarrow -i\hbar\nabla$ para los coeficientes de la serie de Fourier $a_{\bm{k}}^{(\pm 1)}(t)$, es posible demostrar que el Hamiltoniano dado se vuelve:
\begin{equation}
\hat H = \sum_{\bm{k},\mu} \hbar\omega_{\bm{k}}\left(\hat a^{\dagger(\mu)}(\bm{k})\hat a^{(\mu)}(\bm{k}) + \frac{1}{2}\right).
\end{equation}

Este Hamiltoniano se asemeja mucho al de un oscilador armónico expresado en función de los operadores $\ad$ de creación y $\hat a$ de aniquilación:
\begin{equation}
\hat H = \hbar\omega\left(\ad\hat a + \frac{1}{2}\right).
\end{equation} 
Esto, y la naturaleza ondulatoria y periódica de la luz, hacen razonable describir el comportamiento cuántico en el formalismo del oscilador armónico. Los eigenestados de este Hamiltoniano son $|n\rangle$, y les corresponde una energía:
\begin{align}
E_n &= \hbar\omega\left(n + \frac{1}{2}\right) & n &= 1,2,3,... \label{eq_energia_oscilador}
\end{align}

Los operadores $\ad$ y $\hat a$ actúan en estos estados de la forma:
\begin{align*}
\ad\hat a|n\rangle &= \hat n|n\rangle,\\
\hat a|n\rangle &= \sqrt{n}|n-1\rangle,\\
\ad|n\rangle &= \sqrt{n+1}|n+1\rangle.
\end{align*}

En la descripción de óptica cuántica, estos estados $|n\rangle$ describe el número de exitaciones con energía $\hbar\omega$; estas exitaciones reciben el nombre de \textit{fotones}.

\subsubsection{Estadística de fotones}\label{estadistica}
La óptica cuántica está encargada de estudiar a los haces de luz como un chorro de fotones en vez de la descripción clásica de ondas. Para hacer esto, es útil ver estudiar la estadistica de este haz de fotones. La intensidad de este campo está dado por el valor esperado del operador $\hat n$, que es equivalente al número promedio de fotones en el haz. Esto quiere decir que:
\begin{equation}
\langle I \rangle \propto \langle \hat n \rangle  = \langle \ad \hat a \rangle \equiv \bar n.
\end{equation}
Con esto, vale la pena volver a definir la función de correlación de segundo orden en función del operador $\hat n$:
\begin{align}
\g{2}(\tau) = \cfrac{\langle \ad(t)\ad(t+\tau) \hat a(t+\tau)\hat a(t)\rangle}{\langle\ad(t)\hat a(t)\rangle\langle\ad(t+\tau)\hat a(t+\tau)\rangle} = \cfrac{\langle \hat n(t) \hat n (t+\tau)\rangle}{\langle \hat n(t)\rangle \langle \hat n(t+\tau)\rangle}. \label{g2_cuantica}
\end{align}

Veamos los resultados de $g{2}(\tau)$ para las fuentes de luz usadas en en \ref{coherencia}.

Para un haz coherente, nos preguntamos cuál es la probabilidad $\mathcal{P}(n)$ de encontrar $n$ fotones en un haz de longitud $L$ partido en $N$ subsegmentos. Usando la distribución binomial para encontrar la probabilidad de $n$ segmentos con un fotón y $N-n$ con ninguno, tenemos que:
\begin{equation}
\nonumber\mathcal{P}(n)  = \cfrac{N!}{n!(N-n)!}p^n(1-p)^{N-n}.
\end{equation}

Como $p = \bar n/N$, tenemos que:
\begin{equation}
\nonumber \mathcal{P}(n) = \cfrac{N!}{n!(N-n)!}\left(\cfrac{\bar n}{N}\right)^n\left(1-\cfrac{\bar n}{N}\right)^{N-n} = \cfrac{1}{n!}\left(\cfrac{N!}{(N-n)!N^n}\right)\bar n ^n\left(1-\cfrac{\bar n}{N}\right)^{N-n}.
\end{equation}

Queremos tomar el límite cuando $N\rightarrow\infty$. Usando la fórmula de Stirling para probar que
\begin{equation}
\nonumber \lim_{N\rightarrow\infty}\left[\cfrac{N!}{(N-n)!N^n}\right] = 0, 
\end{equation}
y el teorema del binomio para probar que
\begin{equation}
\nonumber \left(1-\cfrac{\bar n}{N}\right)^{N-n} = \exp(-\bar n),
\end{equation}
tenemos que la probabilidad $\mathcal{P}(n)$ cuando $N\rightarrow\infty$ es:
\begin{align}
\mathcal{P}(n) &= \cfrac{\bar n^n}{n!}e^{-\bar n}, & n&=0,1,2,... \ ,
\end{align}
que es una \textbf{distribución Poissoniana}. En general, una distribución Poissoniana expresa la probabilidad de que ocurra un número de eventos en un tiempo dado si hay una frecuencia de ocurrencia media y cada evento es independiente de todos los demás. Esto significa que la detección de cada fotón está aleatoriamente espaciada. Para este tipo de distribuciones, la \textit{varianza} está dada por:
\begin{equation}
(\Delta n)^2 =\sum_{n=0}^\infty(n-\bar n)^2\mathcal{P}(n) = \bar n, \label{varianza}
\end{equation}
lo que significa que la \textit{desviación estándar} cumple con
\begin{equation}
\Delta n = \sqrt{n}.
\end{equation}

Por otro lado, la luz térmica está definida como la radiación electromagnética emitida por un cuerpo negro, y presentan una densidad de energía dentro del rango de emisión $[\omega, \omega + d\omega]$ de acuerdo a la Ley de Planck:
\begin{equation}
\nonumber\rho(\omega,T)d\omega = \frac{\hbar\omega^3}{\pi^2c^3}\cfrac{d\omega}{\exp(\hbar\omega/k_BT)-1}.
\end{equation}
Cada modo oscilatorio tiene la energía dada por \ref{eq_energia_oscilador} y, de acuerdo a la mecánica estadística, la probabilidad de que se encuentren $n$ fotones en el modo correspondiente a $\omega$ es:
\begin{equation}
\mathcal{P}_{\omega}(n) = \cfrac{\exp(-n\hbar\omega/k_BT)}{\sum_{n=0}^\infty\exp(-n\hbar	\omega/k_BT}). \label{prob_termica}
\end{equation}
Para este tipo de luz, es posible demostrar que $\bar n = 1/(\exp(\hbar\omega/k_BT)-1)$, y la probabilidad \ref{prob_termica} es :
\begin{equation}
\mathcal{P}_{\omega}(n) = \cfrac{1}{\bar n+1}\left(\cfrac{\bar n}{\bar n + 1}\right)^n,
\end{equation}
que es una \textbf{distribución de Bose-Einstein}. Para este tipo de luz,
\begin{equation}
(\Delta n)^2 = \bar n + \bar n^2 \geq \bar n.
\end{equation}
Este resultado nos muestra que que la varianza de una distribución de Bose-Einstein siempre es mayor que la de una distribución Poissoniana. Las fluctuaciones de intensidad en la luz caótica clásica se asemejan mucho a las de la luz térmica descritas aquí, y presentan una estadistica similar.

Con este análisis, es conveniente definir una clasificación para las estadísticas de fotones en función de su desviación estándar:
\begin{itemize}
\item \textbf{super-Poissoniana}: $\Delta n > \sqrt n$,
\item \textbf{Poissoniana}: $\Delta n = \sqrt n$,
\item \textbf{sub-Poissoniana}: $\Delta n < \sqrt n$. 
\end{itemize}

La interpretación de que la luz térmic sea super-Poissoniana significa que los fotones que se detectan vienen en promedio con una separación temporal menor a la frecuencia media de ocurrencia, lo que sugiere que llegan en ``paquetes" (o \textit{bonches}). A este efecto se le conoce como \textit{bunching}.

Veamos a $\g{2}(\tau = 0)$. Utilizando la regla de conmutación $[\hat a,\ad] = 1$ podemos encontrar de la ecuación \ref{g2_cuantica} que:
\begin{equation}
\g{2}(0) = \cfrac{\langle\hat n^2\rangle - \langle\hat n\rangle}{\langle\hat n\rangle} = 1+ \cfrac{\Delta n^2 - \bar n}{\bar n ^2}.
\end{equation}
Vemos con esto que para luz perfectamente coherente, $\g{2}(0) = 1$ y que para luz térmica, $\g{2}(0) > 1$. Sin embargo, si tuviéramos una distribución sub-Poissoniana, se tiene que $\g{2}(0) < 1$. Notemos que en la descripción clásica, de acuerdo a la ecuación \ref{g0_clasica}, cualquier campo electromagnético cumple que $\g{2}(0) \geq 1$ y no es posible encontrar un equivalente clásico al resultado para una distribución sub-Poissoniana.

Este resultado ---contrastando con el efecto de bunching--- significa que los fotones tienden a no llegar al detector muy cerca uno de otro. Si este efecto es constante (es decir, si los fotones llegan regularmente espaciados uno después de otro), se le conoce como \textit{antibunching}.\footnote{Es importante decir que una estadística sub-Poissoniana no necesariamente quiere decir que hay detrás un proceso óptico que presente antibunching\cite{PhysRevA.41.475}. Sin embargo, por simplicidad, se le considerará así en este trabajo pues son dos efectos que muy frecuentemente se presentan juntos.} El hecho que $\g{2}(0) < 1$ nos dice que la fuente del campo electromagnético que se está analizando no puede ser descrito de manera clásica y es un claro ejemplo de la naturaleza cuántica de la luz.

Podemos ver los resultados obtenidos en esta sección para la estadística de fotones en la tabla \ref{valores_g0}:
\begin{table}[]
\centering
\label{valores_g0}
\begin{tabular}{|c|c|c|c|}
\hline
\textbf{Descripción clásica} & \textbf{Efecto de fotones} & \textbf{Estadística} & \textbf{$\g{2}(0)$} \\ \hline
Luz caótica o térmica        & Bunching                   & Super-Poissoniana          & $>1$                \\ \hline
Coherente                    & Aleatorios                 & Poissoniana		           & $=1$                \\ \hline
---                          & Antibunching               & Sub-Poissoniana            & $<1$                \\ \hline
\end{tabular}
\caption{$\g{2}(0)$ y su correspondiente estadística y descripción clásica para distintas fuentes de luz.}
\end{table}

\subsection{Sistemas}\label{sistemas_correlaciones}
La principal parte del trabajo de este capítulo consistió en la elaboración de distintos programas y sistemas que serán de utilidad para el experimento de FWM en átomos fríos. Estos sistemas consistieron en un perfilador de haces Gaussianos, la paquetería de uso del TDC y el sistema de adquisición, el sistema de \textit{gating} y parte del sistema de control.

\subsubsection{Perfilómetro}\label{perfilometro}
Poder caracterizar y manipular un haz láser de manera adecuada siempre es ventajoso en un laboratorio de óptica pues permite optimizar algunas aplicaciones de dicha luz, como acoplamiento a fibras ópticas.

Una manera de caracterizar un haz es analizando su perfil de intensidad espacial en un plano perpendicular a su dirección de propagación. Este perfil de intensidad será distinto para cada láser dependiendo de la cavidad que tenga, aunque un perfil Gaussiano es común en láseres utilizados en el laboratorio. La propagación de los láseres del laboratorio puede aproximarse bastante bien asumiendo que tienen una distribución Gaussiana en 2-D, que corresponde a un perfil de intensidad:
\begin{equation}
I(r) = I_0 e^{\frac{-2r^2}{w^2}},
\end{equation}
donde $r^2 = x^2 + y^2$ y $w$ representa el diámetro del haz. $w$ es en realidad una función de la distancia a partir del plano en el que el frente de onda es plano, pero para un corte transversal es constante \cite{CVI}.

Hay varias definicones de diámetro de haz, y aunque para haces Gaussianos la más común es el diámetro para el cual la intensidad ha caído a $1/e^2$ (13.5 \%) de su intensidad original. Otras definiciones --- útiles en distintos contextos --- son el diámetro $1/e$, \textit{full-width half-maximum} (FWHM) y $D4\sigma$, que corresponden a caídas de intensidad a $1/e$ y $50\%$ para las primeras dos, respectivamente, y 4 veces la desviación estándar para la última. Para haces Gaussianos ideales, los diámetros de $1/e^2$ y $D4\sigma$ coinciden.

\textbf{GRÁFICA DE PERFIL GAUSSIANO Y DIÁMETROS}

Haciendo uso de una cámara digital, es posible tomar una foto del perfil de intensidad espacial en un plano perpendicular y realizar un análisis en la computadora. La cámara disponible para ese propósito en el laboratorio es una cámara Thorlabs DCC1545M, que cuenta con un chip CCD con una resolución de 1280x1024 pixeles cuadrados de $5.4\mu m$ de lado. El chip CCD tiene una intensidad de saturación de aproximadamente $1\mu W/cm^2$, lo que significa que atenuar la luz láser usando filtros de densidad neutral (ND) es necesario.

\textbf{FOTO DE HAZ LASER, LIMPIO Y CON INTERFERENCIA}

Una vez que una foto ha sido tomada, es procesada por la computadora y convertida en una matriz de valores dentro del intervalo $[0,255]$ (pues la cámara toma fotos en 8-bits). Después, el algoritmo realiza un procesamiento sencillo para reducir el ruido en la imagen, ruido que puede provenir tanto de ruido eléctrico en el sensor o por luz de fondo. El algoritmo calcula un valor de offset basado en el valor mediano de los pixeles no iluminados por el haz.

Para el análisis de imágenes, primero hace falta encontrar el centro del haz. La figura \textbf{FOTO DE ARRIBA} b) muestra que a veces es difícil tener una imagen limpia. A veces el uso de filtros ND distorsiona el modo y el perfil de un haz, o se puede presentar interferencia por la óptica usada. Por esto, encontrar el centro de un perfil de intensidad a veces no es directo como encontrar el pixel de mayor intensidad.

Normalmente, este ruido puede arreglarse si uno usa un iris o limpia bien la óptica, pero a veces es riesgoso cuando el arreglo es grande o complicado. En casos como este, es posible hacer un preprocesamiento de la imagen para intentar limpiar un poco el ruido.

%https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3749244/pdf/1472-6807-11-7.pdf
%http://www.globalsino.com/EM/page1705.html
%https://www.google.com.mx/search?client=opera&q=fourier+transform+image+mask&sourceid=opera&ie=UTF-8&oe=UTF-8
\textbf{FOURIER}

\textbf{DIAGRAMA DE FFT}

La idea de este pre-procesamiento consiste en remover el ruido en el dominio de frecuencias por medio de la transformada discreta de Fourier en 2D (utilizando el algoritmo de la transformada rápida, o FFT). Para analiar espectros, es conveniente utilizar el hecho de que la transformada de una distribución Gaussiana es también una Gaussiana:
\begin{align*}
\mathcal{F}\{I(x,y)\} &= \hat I (u,v) = \int\int I_0\exp\left(-\cfrac{x^2+y^2}{r_0^2}\right)\exp(-i2\pi (ux+vy))dxdy \\
&= I_0\int \exp\left(-\cfrac{x^2}{r_0^2}\right)\exp(-i2\pi ux)dx\int\exp\left(-\cfrac{y^2}{r_0^2}\right)\exp(-i2\pi vy)dy \\
&= I_0\left(\cfrac{\sqrt{\pi}}{r_0}\exp(-\pi^2 r_0^2u^2)\right)\left(\cfrac{\sqrt{\pi}}{r_0}\exp(-\pi^2 r_0^2v^2)\right) \\
&= I_0\cfrac{\sqrt{\pi}}{r_0}\exp(-\pi^2 r_0^2(u^2+v^2)) = \hat{I_0}\exp\left(-\cfrac{u^2+v^2}{z_0^2}\right),
\end{align*}

donde $\hat I_0 = I_0\cfrac{\sqrt{\pi}}{r_0}$ es la nueva amplitud de la distribución y $z_0 = \cfrac{1}{\pi r_0}$ es el nuevo radio. Observamos que si tenemos un haz con perfil ancho, se convertirá en un perfil delgado en el espacio de frecuencias.

\textbf{ESPECTRO + ESPECTRO FILTRADO}

Viendo el espectro de frecuencias, podemos bloquear los puntos que no correspondan al espectro de nuestra Gaussiana. A esto lo llamaremos una \textit{máscara} o filtro. La calidad de la imagen que obtengamos dependerá de la manera en la que se filtran las frecuencias no deseadas\cite{Chen}, en este algoritmo se hace una máscara muy simple. Finalmente, se aplica la transformada inversa de Fourier y se observa que el perfil puede haber mejorado un poco.

\textbf{PERFIL MEJORADO}

Dependiendo de cuánto se bloquee en el espacio de frecuencias cambiará la calidad de la imagen reconstruida: si se bloquea muy poco, no habrá mejora, si se bloquea mucho, se puede perder información del perfil. Esta herramienta es útil cuando se prefiere una estimación medianamente precisa del ancho de un haz con mucho ruido y no se puede arreglar la imagen del con óptica, por lo que se recomienda no abusar de ella para obtener una medición confiable.

Después del pre-procesamiento, se encuentra el \textit{centro de gravedad de la imagen} con un cálculo del primer momento de la intensidad del haz sobre la superficie del CCD en ambas direcciones\cite{ISO11146-1}:
\begin{align*}
\langle x \rangle &= \frac{\int I(x,y)x \ dxdy}{\int I(x,y) \ dxdy} & \langle y \rangle &= \frac{\int I(x,y)y \ dxdy}{\int I(x,y) \ dxdy}.
\end{align*}

El algoritmo realiza esta integral de manera discreta a lo largo de cada columna y cada fila del arreglo para encontrar el valor de la proyección sobre cada eje. Una vez encontrado el centro del haz, el algoritmo procede a hacer un ajuste una distribución Gaussiana por medio de mínimos cuadrados:

\begin{equation*}
G(x) = Ae^{-\frac{(x-\mu)^2}{2\sigma^2}},
\end{equation*}
%https://www.researchgate.net/publication/252062037_A_Simple_Algorithm_for_Fitting_a_Gaussian_Function_DSP_Tips_and_Tricks

donde $A$ es la amplitud de la Gaussiana, $\mu$ es su valor esperado y $\sigma$ la desviación estándar. Finalmente, calcula el diámetro para una de las cuatro definiciones.

Además de existir como una biblioteca de funciones independiente, se escribió una interfaz gráfica para utilizar el programa como un ejecutable. Actualmente el programa ha pasado a ser utilizado cotidianamente por todos los usuarios del Laboratorio.

\subsubsection{Sistema de adquisición}\label{adquisicion}

El sistema de adquisición consiste en la paquetería de programación del TDC y el programa de visualización de cuentas. El TDC es un convertidor de cuentas de tiempo a valores digitales que consta en un circuito integrado de aplicación específica (ASIC) que registra eventos en los 8 canales del módulo y los manda a una matriz de puertas programable (FPGA) que los ordena, comprime y calcula tasas de coincidencia para los primeros 4 canales.

El TDC cuenta con un búfer de entrada que trabaja a una velocidad de $200$ millones de eventos por segundo, que resulta en una resolución temporal de $5.5ns$ para eventos consecutivos registrados en el mismo canal. Sin embargo, la resolución temporal para eventos registrados en distintos canales es de $\approx 81 ps$.

Para realizar la comunicación entre el TDC y el resto de los sistemas del laboratorio, fue necesario escribir una paquetería en Python. Esta paquetería se escribió como un controlador para el TDC basada en los archivos compilados por el fabricante (bibliotecas de enlace dinámico, o \textit{DLL}). Un pequeño manual se puede encontrar en el \textbf{ANEXO A??} y la paquetería está disponible en \textbf{REFERENCIA GITHUB} para uso público.

Se escribió también un programa de visualización de datos en tiempo real con dos funciones específicas de conteo de datos:
\begin{itemize}
\item Una función que integra el número de eventos por unidad de tiempo para cada canal.
\item Un analizador de diferencias temporales: tomando un evento en un canal como un \textit{inicio}, y el siguiente como un \textit{fin}. De estas diferencias se construye un histograma útil para ver las diferencias temporales entre distinas señales (distintos canales). 
\end{itemize}

\begin{verbatim}
def hola(text):
    return mundo
\end{verbatim}


\subsubsection{Gating}\label{gating}

\subsubsection{Sistema de control}\label{control}

\subsection{Resultados}\label{resultados_correlaciones}
